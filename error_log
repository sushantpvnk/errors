KUBECONFIG = credentials('minikube-kubeconfig')

stage('Deploy to Kubernetes') {
            steps {
                script {
                    sh 'kubectl apply -f k8s/deployment.yaml' // Ensure kubectl is installed and configured
                }
            }
        }






sushant@sushant-VirtualBox:~$ cat ~/.kube/config
apiVersion: v1
clusters: null
contexts: null
current-context: ""
kind: Config
preferences: {}
users: null



pipeline {
    agent any
    
    tools{
        jdk 'jdk17'
        maven 'maven3'
    }
    
    environment{
        SCANNER_HOME = tool 'sonar-scanner'
    }
    stages {
        stage('Git Checkout') {
            steps {
                git branch: 'main', credentialsId: 'github_token', url: 'https://github.com/sushantpvnk/Boardgame.git'
            }
        }
        stage('Compile'){
            steps{
                sh "mvn compile"
            }
        }
        stage('Test'){
            steps{
                sh "mvn test"
            }
        }
        stage('SonarQube Analysis'){
            steps{
                withSonarQubeEnv('sonar') {
                    sh ''' $SCANNER_HOME/bin/sonar-scanner -Dsonar.projectName=BoardGame -Dsonar.projectKey=BoardGame \
                            -Dsonar.java.binaries=. '''
                }
            }
        }
        stage('Build'){
            steps{
                sh "mvn package"
            }
        }
        stage('Build'){
            steps{
                sh "mvn package"
            }
        }
        stage('Build and Tag Docker Image'){
            steps{
                script{
                    withDockerRegistry(credentialsId: 'docker_cred', toolName: 'docker') {
                        sh 'docker build -t sushant1102/boardgame:latest .'
                        
                    }
                }
            }
        }
        stage('Build and Tag Docker Image'){
            steps{
                script{
                    withDockerRegistry(credentialsId: 'docker_cred', toolName: 'docker') {
                        sh 'docker push sushant1102/boardgame:latest'
                        
                    }
                }
            }
        }
    }
}







Started by user admin

Running as SYSTEM
Building in workspace /var/lib/jenkins/workspace/memories_mern
[WS-CLEANUP] Deleting project workspace...
[WS-CLEANUP] Deferred wipeout is used...
[WS-CLEANUP] Done
The recommended git tool is: NONE
using credential github_token
Cloning the remote Git repository
Cloning repository https://github.com/sushantpvnk/Memories.git
 > git init /var/lib/jenkins/workspace/memories_mern # timeout=10
Fetching upstream changes from https://github.com/sushantpvnk/Memories.git
 > git --version # timeout=10
 > git --version # 'git version 2.43.0'
using GIT_ASKPASS to set credentials 
 > git fetch --tags --force --progress -- https://github.com/sushantpvnk/Memories.git +refs/heads/*:refs/remotes/origin/* # timeout=10
 > git config remote.origin.url https://github.com/sushantpvnk/Memories.git # timeout=10
 > git config --add remote.origin.fetch +refs/heads/*:refs/remotes/origin/* # timeout=10
Avoid second fetch
 > git rev-parse refs/remotes/origin/master^{commit} # timeout=10
 > git rev-parse origin/master^{commit} # timeout=10
ERROR: Couldn't find any revision to build. Verify the repository and branch configuration for this job.
Finished: FAILURE
















mongodb+srv://sushant:dbUserPassword@cluster0.o19fj.mongodb.net/?retryWrites=true&w=majority&appName=Cluster0


ERROR: Couldn't find any revision to build. Verify the repository and branch configuration for this job.
Finished: FAILURE

sonar-scanner \
  -Dsonar.projectKey=memories_sonar \
  -Dsonar.sources=. \
  -Dsonar.host.url=http://localhost:9000 \
  -Dsonar.token=sqp_528fafcc5c445f0b9fe3d50a0b873162a35b7a1b

+ sonar-scanner -Dsonar.projectKey=memories_sonar -Dsonar.sources=. -Dsonar.host.url=http://localhost:9000 -Dsonar.token=sqp_c648599bced301a1277cd0d990b935a715845a6d
/tmp/jenkins4012749612844178291.sh: 2: sonar-scanner: not found
Build step 'Execute shell' marked build as failure
Finished: FAILURE








Compiled with warnings.

Warning
(6:29521) autoprefixer: Replace color-adjust to print-color-adjust. The color-adjust shorthand is currently deprecated.

Search for the keywords to learn more about each warning.
To ignore, add // eslint-disable-next-line to the line before.

WARNING in ./node_modules/bootstrap/dist/css/bootstrap.min.css (./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[1].oneOf[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[1].oneOf[5].use[2]!./node_modules/source-map-loader/dist/cjs.js!./node_modules/bootstrap/dist/css/bootstrap.min.css)
Module Warning (from ./node_modules/postcss-loader/dist/cjs.js):
Warning

(6:29521) autoprefixer: Replace color-adjust to print-color-adjust. The color-adjust shorthand is currently deprecated.

webpack compiled with 1 warning



sushant@sushant-VirtualBox:~/Desktop/to-do-app/client$ npm install autoprefixer@latest --save-dev

changed 1 package, and audited 1694 packages in 36s

261 packages are looking for funding
  run `npm fund` for details

8 vulnerabilities (2 moderate, 6 high)

To address all issues (including breaking changes), run:
  npm audit fix --force

Run `npm audit` for details.
